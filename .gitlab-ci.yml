
include:
  - local: .gitlab/infrastructure.yml
  - local: .gitlab/stage_clear_cache.yml
  - local: .gitlab/stage_build_base.yml
  - local: .gitlab/stage_provision_client.yml
  - local: .gitlab/stage_image_check.yml
  - local: .gitlab/stage_build.yml
  - local: .gitlab/end_to_end.yml

stages:
  - ci-infrastructure-check
  - trigger-infrastructure
  - signal
  - clear-docker-cache
  - build-base
  - provision-client
  - image-check
  - build
  - end-to-end-setup-arango
  - end-to-end-setup
  - end-to-end-test

# WARNING
#
# Do not put if else statements without if and else, gitlab yaml does not like
# this kind of scripting
#
# [ -f file_path ] && ok do this....
variables:
  HARBOR_USER: 'robot$$datafed+harbor_datafed_gitlab_ci_registry_2'
  REGISTRY: 'camden.ornl.gov'
  DATAFED_DEPENDENCIES_INSTALL_PATH: "/shared/install"

