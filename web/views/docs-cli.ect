<!DOCTYPE html>
<html>
    <head>
        <% include 'head.ect' %>
        <title>DataFed CLI Help</title>
    </head>

<body class='' style='height:100%'>
    <div class="col-flex" style="height:100%;width:100%">
        <div class="ui-widget-header" style="flex:none;padding:.25em .5em">
            <div style="font-size:2em;">DataFed - Command-Line-Interface Help &amp Installation </div>
        </div>

        <div class='row-flex' style="flex:auto;min-height:0px">
            <div class="ui-widget-content content" style="flex:none;overflow:auto;padding:.25em">
                <h2>Contents</h2>
                <a href='#s1'>1. Introduction</a><br>
                <a href='#s2'>2. Installation</a><br>
                &nbsp&nbsp<a href='#s21'>2.1 Configuration Options</a><br>
                &nbsp&nbsp<a href='#s22'>2.2 Server Public Key</a><br>
                &nbsp&nbsp<a href='#s22'>2.3 Automatic Authentication</a><br>
                <a href='#s3'>3. Commands</a><br>
                <a href='#s4'>4. Client API</a><br>
            </div>
            <div class='ui-widget-content' style='flex:auto;height:auto;overflow:auto;padding: 0em 2em 0em 2em'>

<h2 id='s1'>1. Introduction</h2>

<p>The DataFed command-line-interface (CLI) provides access to basic DataFed features for both interactive use and scripting. The DataFed CLI is provided via a Python3 package, called "datafed", available on PyPi and installable using the Python pip tool. The "datafed" package also contains a Python API that can be used to build custom Python applications that directly interface with DataFed. (A C++ client library is also available from the DataFed code repository.)</p>

<h2 id='s2'>2. Installation</h2>

<p>The DataFed CLI is typically pre-installed within the supported compute and data environments of DataFed Network member facilities. Please refer to the DataFed Network Directory to see a listing of member facilities along with site-specific access information. If you need to use the DataFed CLI from a non-supported facility or environment, then you will need to install and configure the CLI manually.</p>

<p>The DataFed Python CLI is installed using Python's built-in package installer tool, "pip", using the following command:<p>

<pre style='margin:0 5em'>pip install datafed</pre>

<h3 id='s21'>2.1 Configuration Options</h3>

<span style='color:red'>TO DO: LIST AND DESCRIBE ALL OPTIONS</span>

<h3 id='s22'>2.2 Server Public Key</h3>

<p>A current DataFed server public key must be downloaded and installed for the DataFed CLI to authenticate and communicate securely with the central DataFed services. The latest public key is available for download from the following link:</p>

<a href='/datafed-core-key.pub' style='margin:0 5em'>Download DataFed Server Public Key</a>

<p>The server public key must be installed locally such that it is readable by the DataFed CLI. By default, the CLI looks for the server public key under the "~/.datafed/" directory; however, any path may be used so long as the CLI is configured to look in the proper location (see Configuration Options, above).</p>

<h3 id='s22'>2.3 Automatic Authentication</h3>

<p>Once the CLI is properly installed, automatic authentication can be enabled for the CLI by installing local client credentials. This is done by simply running the following command from the environment to be configured for automatic authentication:</p>

<pre style='margin:0 5em'>datafed setup</pre>

<p>After manual authentication, this command will install local user credentials in the configured client credentials directory (see Configuration Options, above). Subsequent use of the DateFed CLI within this environment will authenticate using the installed local credentials. These credential files must be protected and kept private. In the event of a security incident, automatic authentication can be disabled by deleting the local credential files: "datafed-user-key.pub" and "datafed-user-key.priv". Alternatively, all of a user's installed credentials can be revoked from the DataFed Web Portal using the "Revoke Credentials" button in the application settings dialog. (This does not delete local credential files, but invalidates the keys on the server side.)</p>
<h2 id='s3'>3. Commands</h2>

<span style='color:red'>TO DO: LIST AND DESCRIBE ALL COMMANDS WITH OPTIONS</span>

<h2 id='s4'>4. Client API</h2>

<p>The DataFed Python CLI package includes a client library module, "ClientLib.py", used by the CLI to communicate with central DataFed services. This module is available for integration into custom, user-created Python applications. The ClientLib module provides basic connectivity and authentication functionality, as well as access to the underlying message-based application programming interface (MAPI) used by DataFed services. The DataFed MAPI (requests, replies, and associated data structures) is defined by a set of included Google Protocol Buffer files (.proto extension). At a very basic level, an application would created, initialize, and send a request message to the DataFed server using functions in the ClientLib module. Subsequent reply messages are received (synchronously or asynchronously) and decoded for processing by the application.</p>
<p>A similar C++ client library is also available in the DataFed code repository, at https://github.com/ORNL/DataFed. Please refer to the DataFed MAPI documentation for further information regarding both the Python and C++ MAPIs. All documentation is located in the "/docs" folder of the DataFed code repository.</p>
            </div>
        </div>
    </div>
</body>
</html>
