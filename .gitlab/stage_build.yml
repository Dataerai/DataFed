---
#run-ws-build-job:
#  needs:
#    - job: build-dependencies
#    - job: build-runtime
#    - job: check-ws-image
#      artifacts: true
#  stage: build
#  trigger:
#    include:
#      - artifact: ws_image.yml
#        job: check-ws-image
#    strategy: depend
#  variables:
#    REGISTRY: "${REGISTRY}"
#    HARBOR_USER: "${HARBOR_USER}"
#    HARBOR_DATAFED_GITLAB_CI_REGISTRY: "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"

run-core-build-job:
  needs:
    - job: build-runtime
    - job: check-core-image
    #    - job: build-dependencies
      artifacts: true
  stage: build
  trigger:
    include:
      - artifact: core_image.yml
        job: check-core-image
    strategy: depend
  variables:
    REGISTRY: "${REGISTRY}"
    HARBOR_USER: "${HARBOR_USER}"
    HARBOR_DATAFED_GITLAB_CI_REGISTRY: "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"

#run-repo-build-job:
#  needs:
#    - job: build-dependencies
#    - job: build-runtime
#    - job: check-repo-image
#      artifacts: true
#  stage: build
#  trigger:
#    include:
#      - artifact: repo_image.yml
#        job: check-repo-image
#    strategy: depend
#  variables:
#    REGISTRY: "${REGISTRY}"
#    HARBOR_USER: "${HARBOR_USER}"
#    HARBOR_DATAFED_GITLAB_CI_REGISTRY: "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"
#
#run-gcs-base-build-job:
#  needs:
#    - job: build-dependencies
#    - job: build-runtime
#    - job: check-gcs-base-image
#      artifacts: true
#  stage: build
#  trigger:
#    include:
#      - artifact: gcs_base_image.yml
#        job: check-gcs-base-image
#    strategy: depend
#  variables:
#    REGISTRY: "${REGISTRY}"
#    HARBOR_USER: "${HARBOR_USER}"
#    HARBOR_DATAFED_GITLAB_CI_REGISTRY: "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"
#    DATAFED_GCS_SUBMODULE_VERSION: "${DATAFED_GCS_SUBMODULE_VERSION}"
#
#run-gcs-build-job:
#  needs:
#    - job: build-dependencies
#    - job: build-runtime
#    - job: run-gcs-base-build-job
#    - job: check-gcs-image
#      artifacts: true
#  stage: build
#  trigger:
#    include:
#      - artifact: gcs_image.yml
#        job: check-gcs-image
#    strategy: depend
#  variables:
#    REGISTRY: "${REGISTRY}"
#    HARBOR_USER: "${HARBOR_USER}"
#    HARBOR_DATAFED_GITLAB_CI_REGISTRY: "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"
#
#run-foxx-build-job:
#  needs:
#    - job: build-dependencies
#    - job: build-runtime
#    - job: check-foxx-image
#      artifacts: true
#  stage: build
#  trigger:
#    include:
#      - artifact: foxx_image.yml
#        job: check-foxx-image
#    strategy: depend
#  variables:
#    REGISTRY: "${REGISTRY}"
#    HARBOR_USER: "${HARBOR_USER}"
#    HARBOR_DATAFED_GITLAB_CI_REGISTRY: "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"



      #build-python-client-base:
      #  needs: ["clear-python-client-cache"]
      #  variables:
      #    IMAGE_TAG: "datafed/python-client-base"
      #    GIT_STRATEGY: clone
      #  stage: build
      #  tags:
      #    - docker
      #    - ci-datafed-client
      #  script:
      #    - BRANCH_LOWER=$(echo "$CI_COMMIT_REF_NAME" | tr '[:upper:]' '[:lower:]')
      #    - docker system prune -f
      #    - docker build -f python/docker/Dockerfile.python-client-base.ubuntu -t "${REGISTRY}/${IMAGE_TAG}-${BRANCH_LOWER}:latest" .
      #    - docker login "${REGISTRY}" -u "${HARBOR_USER}" -p "${HARBOR_DATAFED_GITLAB_CI_REGISTRY}"
      #    - docker push "${REGISTRY}/${IMAGE_TAG}-${BRANCH_LOWER}:latest"


